<!DOCTYPE html>
<html lang="en" class="no-js">
    <head>
        <meta charset="utf-8">
        <title>报名参赛</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
        <!-- CSS -->
        <link rel="stylesheet" href="<?php echo base_url('application/views/contest/assets/css/reset.css');?>">
        <link rel="stylesheet" href="<?php echo base_url('application/views/contest/assets/css/supersized.css');?>">
        <link rel="stylesheet" href="<?php echo base_url('application/views/contest/assets/css/style.css');?>">
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        
<style>
  br { clear: both; }
      .cntSeparator {
        font-size: 54px;
        margin: 10px 7px;
        color: #000;
      }
      .desc { margin: 7px 3px; }
      .desc div {
        float: left;
        font-family: Arial;
        width: 70px;
        margin-right: 70px;
        font-size: 25px;
        font-weight: bold;
        color: #000;
      }
.button1{
    background: #ef4300;
    border-color:#ff730e;
}
.button2{
    background: #00CD00;
    border-color:#00EE00;
    margin-top: 25px;
}
.button3{
    background: #00CD00;
    border-color:#00EE00;
    margin-top: 30px;
}
.button4{
    background: #00EE00;
    border-color:#00EE00;
    margin-top:5%;
}
a{
text-decoration:none;
color:#fff;
}
.captcha_style{
    margin-top: 20px;
    margin-left:0;
}
.error_info{
    width: 400px;
    height: 17px;
    margin: 5px;
}
.error_info_enroll{
    width: 300px;
    height: 10px;
    margin: 5px;
    margin-right:0px;
    float: left;
}
.contest_info{
    width: 600px;
    height: 125px;
    margin-top: 25px;
}
.radio_class{
    width: 15px;
    height: 15px;

}
.radio_div{
    width:320px;
    height: 25px;
    margin-left: 100px;
    margin-bottom: 10px;
}
</style>
    </head>
    <body>
        
        <?php if(isset($old_contest) || isset($new_contest)){?>
        <div class="page-container3">

            <div id="enroll_list">
                <div style="color:black;font-size:60px;"><?php echo isset($old_contest['title']) ? $old_contest['title'] : $new_contest['title']; ?></div>
                <div style="color:black;margin-top:3%;"><span>比赛开始时间：<span style="color:red"><?php echo isset($old_contest['start_time']) ? $old_contest['start_time'] : $new_contest['start_time'] ?></span></span><span style="color:black;margin-left:8%">比赛结束时间：<span style="color:red"><?php echo isset($old_contest['end_time']) ? $old_contest['start_time'] :$new_contest['start_time']?></span></span></div>
                <div style="color:black;margin-top:3%;"><span>报名开始时间：<span style="color:red" id="pre_start_time"><?php echo isset($old_contest['pre_start_time']) ? $old_contest['pre_start_time'] : $new_contest['pre_start_time'] ?></span></span><span style="color:black;margin-left:8%">报名结束时间：<span style="color:red" id="pre_end_time"><?php echo isset($old_contest['pre_end_time']) ? $old_contest['pre_end_time'] :$new_contest['pre_end_time']?></span></span></div>
                <div style="color:yellow;font-size:40px;margin-top:5%;"><h2>距离比赛开始还有:</h2></div>
               <div id="counter" style="text-align: center;margin-left:18%;margin-top:8%;"></div>
               <div class="desc" style="text-align: center;margin-left:20%;">
                <div>天</div>
                <div>小时</div>
                <div>分钟</div>
                <div>秒</div>
              </div>
               
               <div style="margin-top: 10%"><button id="view_teams"><a href="" target="_blank" style="color:red;">查看参赛队伍</a></button></div>
               <?php if(isset($check_enroll_old) || isset($check_enroll_new) ):?>
               <button class="button4" disabled="false">您已报名</button>
               <?php endif;?>
               <?php if(!isset($check_enroll_old) && !isset($check_enroll_new) ) :?>
              <button class="button3" type="submit" id="enroll" >报名参赛</button>
              <?php endif;?>
            </div>

                <div id = "enroll_info" style="display:none">
                    <h1 style="color:red">完善参赛信息</h1>
                    <textarea class="contest_info" readonly="readonly">以下是本次比赛的注意事项,请参赛队员认真阅读</textarea>
                <form action="" method="post">

                <div class="radio_div">
                    <span style="color:red;font-size:20px;">选择参赛类型:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <?php if(isset($old_contest)):?>
                <input class="radio_class" type="radio" value="<?php echo $old_contest['contest_id'];?>"  name="group" checked="checked" id="old">&nbsp;<span style="color:red;">老生赛</span>&nbsp;&nbsp;&nbsp;&nbsp;
            <?php endif;
                if(isset($new_contest)):?>
                <input class="radio_class" type="radio" value="<?php echo $new_contest['contest_id'];?>" name="group" id="new">&nbsp;<span style="color:red;">新生赛</span>
                <?php endif;?>
                </div>

                <input type="text" name="usernnum" class="usernnum" placeholder="队长学号">
                <input type="text" name="username" class="username" placeholder="队长姓名">
                
                <div class="error_info_enroll" style="margin-left: 100px;"><span id="usernum_info" style="color:red;"></span></div>
                <div class="error_info_enroll"><span id="username_info" style="color:red;"></span></div>
                <input type="text" name="user1num" class="user1num" placeholder="队员1学号">
                <input type="text" name="user1name" class="user1name" placeholder="队员1姓名">
                
                <div class="error_info_enroll" style="margin-left: 100px;"><span id="user1num_info" style="color:red;"></span></div>
                <div class="error_info_enroll"><span id="user1name_info" style="color:red;"></span></div>
          
                <input type="text" name="user2name" class="user2num" placeholder="队员2学号">
                <input type="text" name="user2name" class="user2name" placeholder="队员2姓名">
                
                <div class="error_info_enroll" style="margin-left: 100px;"><span id="user2num_info" style="color:red;"></span></div>
                <div class="error_info_enroll"><span id="user2name_info" style="color:red;"></span></div>
                <input type="text" name="teamname" class="teamname" placeholder="队伍名称">
                <input type="text" name="phone" class="phone" placeholder="联系方式-手机号">
                <div class="error_info_enroll" style="margin-left: 100px;"><span id="teamname_info" style="color:red;"></span></div>
                <div class="error_info_enroll"><span id="phone_info" style="color:red;"></span></div>
                
                <div class ="log_captcha_style" >
                    <input type="text" class="input-xlarge" id="captcha_r" name="captcha" placeholder="验证码"  style="width:100px;">
                    <img src="<?php echo site_url('oj_index/login/code') ?>" alt="" id="captcha_img_r" onclick= this.src="<?php echo site_url('oj_index/login/code').'/';?>"+Math.random() style="cursor: pointer;" title="看不清？点击更换另一个验证码。" />
                <span style="cursor: pointer;color:red;" id="captcha_span_r">点击刷新图片</span>
                </div>
                <div class="error_info" style="margin-left: 200px;"><span id="captch_info" style="color:red;"></span></div>
                <button class="button1" type="submit">提交报名</button>
                <div class="error"><span>+</span></div>
                </form>
                </div>
        </div>

    <?php } else{ ?>
        <div class="page-container3">
            暂无校赛<br/>
            <a href="<?php echo site_url('oj_index/home');?>">前去练习</a>
        </div>
        <?php }?>

        <!-- Javascript -->
        <script src="<?php echo base_url('application/views/contest/assets/js/jquery-1.8.2.min.js');?>"></script>
        <script src="<?php echo base_url('application/views/contest/assets/js/supersized.3.2.7.min.js');?>"></script>
        <script src="<?php echo base_url('application/views/contest/assets/js/supersized-init.js');?>"></script>
        <script src="<?php echo base_url('application/views/contest/assets/js/scripts.js');?>"></script>
        <input id = "hid_site" type="hidden" value = "<?= site_url();?>" />
        <input id = "hid_base" type="hidden" value = "<?= base_url();?>" />
        <input id = "start_time" type="hidden" value = "<?php if(isset($old_contest['start_time'])) echo $old_contest['start_time']; ?>" />
        <script src="<?php echo base_url('application/views/contest/js/jquery.min.js'); ?>" type="text/javascript" charset="utf-8"></script>
        <script src="<?php echo base_url('application/views/contest/js/jquery.countdown.js'); ?>" type="text/javascript" charset="utf-8"></script>
        <script type="text/javascript">
      $(function(){
        var hid_base = $("#hid_base").val();
        var start_time = $("#start_time").val();
        //console.log(start_time);
        //var time = start_time.split(" ");
        var time = get_unix_time(start_time);
        var timestamp = (new Date()).valueOf();
        timestamp = timestamp.toString().substr(0, 10);
        var time_c =time - timestamp;
        var seconds = time_c % 60;
        var minutes = (parseInt(time_c / 60)) % 60;
        var hours = (parseInt(time_c / 3600)) % 24;
        var days = parseInt(time_c / 86400);
        if(seconds < 10) {
            seconds = "0" + seconds;
        }
        if(minutes < 10) {
            minutes = "0" + minutes;
        }
        if(hours < 10) {
            hours = "0" + hours;
        }
        if(days < 10) {
            days = "0" + days;
        }
        /*console.log(seconds);
        console.log(minutes);
        console.log(hours);
        console.log(days);
        console.log(time_c);*/
        $('#counter').countdown({
          image: hid_base + 'application/views/contest/images/digits.png',
          startTime: days+':'+hours+': '+ minutes + ':'+ seconds,
            timerEnd: function(){  location.reload(); }
        });

      });
      function get_unix_time(dateStr)
    {
        var newstr = dateStr.replace(/-/g,'/'); 
        var date =  new Date(newstr); 
        var time_str = date.getTime().toString();
        return time_str.substr(0, 10);
    }

    </script>
    </body>
</html>

